<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.moreconreviewapi.mapper.ReviewMapper">
    <!-- 도메인 필드(Review)와 실제 컬럼 매핑 -->
    <resultMap id="ReviewResultMap" type="com.example.moreconreviewapi.domain.Review">
        <result property="review_id" column="レビュー識別番号"/>
        <result property="user_id" column="会員識別番号"/>
        <result property="item_id" column="商品識別番号"/>
        <result property="rating" column="レーティング"/>
        <result property="content" column="レビュー内容"/>
        <result property="published" column="公開状態"/>
        <result property="published_date" column="登録日時"/>
    </resultMap>

    <!-- 특정 상품의 공개 리뷰 목록 조회 -->
    <select id="findPublishedReviewsByItemId" parameterType="string" resultMap="ReviewResultMap">
        SELECT
            レビュー識別番号,
            会員識別番号,
            商品識別番号,
            レーティング,
            レビュー内容,
            公開状態,
            登録日時
        FROM レビュー.レビュー
        WHERE 商品識別番号 = #{itemId}
          AND 公開状態 = '公開'
        ORDER BY 登録日時 DESC
    </select>
</mapper>

